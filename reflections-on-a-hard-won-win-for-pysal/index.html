<!DOCTYPE html>
<html lang="en-US">

<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


<head>
<meta charset="utf-8" />
<meta name="author" content="Levi John Wolf" />
<meta name="description" content="just a geograblog" />
<meta name="keywords" content="" />
<meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">
<meta name="generator" content="Hugo 0.40.1" />

<link rel="canonical" href="/reflections-on-a-hard-won-win-for-pysal/">
<base href="/" />
<meta property="og:title" content="Reflections on a hard-won win for PySAL" />
<meta property="og:description" content="As a way to learn Python (and I mean really come to know it), I took on the project of converting PySAL to be compatible with Python 3.
I started work on this two years ago. A tentative candidate for release is available in my fork
Now, I’m glad I did this. I still worry about the day when Apple decides to ship the next OSX (Half Moon Bay? Big Sur?" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/reflections-on-a-hard-won-win-for-pysal/" />



<meta property="article:published_time" content="2015-07-27T21:10:56&#43;00:00"/>

<meta property="article:modified_time" content="2015-07-27T21:10:56&#43;00:00"/>











<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Reflections on a hard-won win for PySAL"/>
<meta name="twitter:description" content="As a way to learn Python (and I mean really come to know it), I took on the project of converting PySAL to be compatible with Python 3.
I started work on this two years ago. A tentative candidate for release is available in my fork
Now, I’m glad I did this. I still worry about the day when Apple decides to ship the next OSX (Half Moon Bay? Big Sur?"/>



<meta itemprop="name" content="Reflections on a hard-won win for PySAL">
<meta itemprop="description" content="As a way to learn Python (and I mean really come to know it), I took on the project of converting PySAL to be compatible with Python 3.
I started work on this two years ago. A tentative candidate for release is available in my fork
Now, I’m glad I did this. I still worry about the day when Apple decides to ship the next OSX (Half Moon Bay? Big Sur?">


<meta itemprop="datePublished" content="2015-07-27T21:10:56&#43;00:00" />
<meta itemprop="dateModified" content="2015-07-27T21:10:56&#43;00:00" />
<meta itemprop="wordCount" content="723">



<meta itemprop="keywords" content="python, gis, python 3, py3k, geography, pysal, statistics, spatial analysis,imported," />


<link rel="stylesheet" href="css/layout.css" />
<style type="text/css">
body {
  background-color: #f5f5f5;
  color: #444444;
}

a { color: #444444; }

pre {
  background: ;
  border: 1px solid #444444;
  border-radius: 5px;
}

code {
  background: ;
}

blockquote {
  background: ;
  border-left: 3px solid #444444;
}

table {
  margin: 1em auto;
  border-collapse: collapse;
}

table, th, td {
  border: 1px solid #444444;
}

th {
  background: #444444;
  color: #f5f5f5;
}

.siteTitle a { color: #e84848; }

.post .content h1{ color: #e84848; }
.post .content h2{ color: #e84848; }
.post .content h3{ color: #e84848; }
.post .content h4{ color: #e84848; }
.post .content h5{ color: #e84848; }
.post .content h6{ color: #e84848; }
.post .content a:hover { color: #e84848; }
.social-link:hover { color: #e84848; }
.nav-item-title:hover { color: #e84848; }
.tag a:hover { color: #e84848; }
.copyright { color: #404040 }
.poweredby { color: #404040 }
.poweredby a { color: #404040; }
.post-preview .title a{ color: #e84848; }
.content-item a:hover{
  text-decoration: underline;
  color: #e84848;
}
.post-list .title { color: #e84848; }
.rmore { color: #e84848; }
.terms .term a:hover {
  text-decoration: underline;
  color: #e84848;
}

</style>



<title>


     Reflections on a hard-won win for PySAL 

</title>

</head>


<body>
<div class="main">
<header>

<div class="header-bar">

  <nav>
    <div class="siteTitle">
      <a href="/">Yet Another Geographer</a>
    </div> 

    
    
    <a class="nav-item" href="/about/"><div class="nav-item-title">About | </div></a>
    
    <a class="nav-item" href="https://www.dropbox.com/s/y5mjkduq7bopzex/currvita.pdf?dl=0"><div class="nav-item-title"> CV |  </div></a>
    
    <a class="nav-item" href="http://www.bristol.ac.uk/geography/people/levi-j-wolf/overview.html"><div class="nav-item-title"> Bristol |  </div></a>
    
    <a class="nav-item" href="https://spatial.uchicago.edu"><div class="nav-item-title"> Chicago |  </div></a>
    
    <a class="nav-item" href="https://spatial.ucr.edu"><div class="nav-item-title"> UCR |  </div></a>
    
    <a class="nav-item" href="/teaching/"><div class="nav-item-title"> Teaching |  </div></a>
    
    <a class="nav-item" href="/geoml-reading-group/"><div class="nav-item-title">Geoml-reading-groups</div></a>
    
    <a class="nav-item active" href="/post/"><div class="nav-item-title">Posts</div></a>
    

  </nav>
</div>

<link rel="shortcut icon" type="image/jpg" href="/favicon.ico">


</header>


<article class="post">
    <h1 class="title"> Reflections on a hard-won win for PySAL </h1>
    <div class="content"> <p>As a way to learn Python (and I mean <strong>really come to know it</strong>), I took on the project of converting <a href="https://github.com/ljwolf/pysal/tree/py3conv" target="_blank">PySAL</a> to be compatible with Python 3.</p>

<p>I started work on this two years ago. A tentative candidate for release is available <a href="https://github.com/ljwolf/pysal/tree/py3conv" target="_blank">in my fork</a></p>

<p>Now, I’m glad I did this. I still worry about the day when Apple decides to ship the next OSX (Half Moon Bay? Big Sur? Salton Sea?) as Python 3 only, like many popular Linux distributions are aiming to.</p>

<p>But, this work was not always so easily motivated. There were countless discussions online that the conversion process wasn’t worth it, that it didn’t really matter, that scientific computing wasn’t ever going to take it up. Some even stated that widespread adoption in the scientific community would <a href="https://jakevdp.github.io/blog/2013/01/03/will-scientists-ever-move-to-python-3/" target="_blank">take quite a bit</a>. None of this was reassuring, no matter how quickly the python 3 <a href="https://python3wos.appspot.com/" target="_blank">Wall of <strike>Shame</strike> Superpowers</a> was changing to green.</p>

<p>I took a lot of solace in Nick Coghlan’s <a href="http://python-notes.curiousefficiency.org/en/latest/python3/questions_and_answers.html" target="_blank">Q &amp; A</a>, and I stumbled through <a href="https://pythonhosted.org/six/" target="_blank">six</a> documentation. I used <a href="https://www.archlinux.org/" target="_blank">Arch Linux</a>, and their move to Python 3 from Python 2 as the default <code>python</code> executable (prompting this <a href="https://www.python.org/dev/peps/pep-0394/" target="_blank">PEP</a>) was super encouraging.</p>

<p>But, as I finally started wrapping my head around how Metaclasses worked and how our library was organized, I realized: This wasn’t as hard as it appeard initially. In fact, I was writing Python 3 code almost by default.</p>

<p>By far, the hardest part of the conversion effort was the fact that every division operation was suspect. In typical, non-scientific applications, which is probably not too hard to fix. But, lacking the most basic of indications about whether or not a <code>float</code> or an <code>int</code> were being passed to <code>/</code> meant that figuring out when and where things could fail was tedious. Indeed, small bugs were uncovered, where floor division defaults in Python 2 could yield wrong answers in statistical calculations given certain input data. No warnings, no errors, but incorrect results: a nightmare for any library maintainer.</p>

<p>This was my first <strong>real</strong> tussle with static v. dynamic typing, and I have to say, I think it really pushed me a little bit closer to actually <em>desiring</em> static typing. Part of the big reason I want PySAL to start being written in python 3 is the benefits of <a href="https://www.python.org/dev/peps/pep-0484/" target="_blank">type annotations</a> (<a href="https://www.youtube.com/watch?v=2wDvzy6Hgxg" target="_blank">Guido’s perspective</a>) to give a <a href="http://wphomes.soic.indiana.edu/jsiek/what-is-gradual-typing/" target="_blank">gradually-typed</a> flavor to Python.</p>

<p>At this point, I’m firmly in the gradual type camp, if not totally won over by Julia’s <a href="http://stackoverflow.com/questions/28078089/is-julia-dynamically-typed" target="_blank">speedups due to type inference</a>. Although, I should admit my formative experiences in Haskell’s <a href="https://en.wikipedia.org/wiki/Hindley%E2%80%93Milner_type_system" target="_blank">type inference system</a> may be resurfacing here. These questions are also driving factors behind the speed of Cython and the <a href="https://www.youtube.com/watch?v=wsczq6j3_bA" target="_blank">slowness of Python</a>: dynamic typing is much slower than static typing, and 99% of the time (in scientific computing) <strong>we don’t need dynamic typing</strong>.</p>

<p>In addition, this was also the first time that I encountered such beautiful things as <a href="http://stackoverflow.com/questions/15458613/python-why-is-read-only-property-writable" target="_blank">read-only properties in new-style classes</a>, but not because I wanted to use them. Instead, some base classes we overrode in subclasses would error out when assignment occurred.</p>

<p>The tricky thing is, these errors <strong>only</strong> arose when assignment happened, so some were working correctly in some cases. In addition, it was difficult to identify which properties needed to be overwritten at what point in the hierarchy, because the underlying inheritance structure was less <em>in code</em> and more <em>in filesystem</em> and replicated (by good ol’ <code>CTRL-c</code>).</p>

<p>Overall, the experience of porting a rather large project between versions has taught me:</p>

<p><ol><li>“<a href="https://www.python.org/dev/peps/pep-0020/" target="_blank">explicit is better than implicit</a>” seems a bit at crossed-purposes with  <a href="https://en.wikipedia.org/wiki/Duck_typing" target="_blank">duck typing</a>, so be explicit about when a duck is a duck if you can.</li>
<li>Namespaces, inheritance, and composition are <em>amazing</em> ideas, and python handles them better than the file system.</li>
<li>Don’t be concerned about “learning” idiomatic Python 3 if you know Python 2.7.  </li>
<li>If given the option to write something in a new feature of a language instead of an old feature, always pick the new feature. By the time you wrap your head around it, it’ll be considered “default” and the old feature will be deprecated.</li>
</ol><p>And, since I’m sitting here, staring at our <code>setup.py</code>, trying to figure out why it won’t correctly <code>build</code> from source, nor install correctly using the <code>build_2to3</code> builder, packaging in Python <a href="https://mail.python.org/pipermail/distutils-sig/2008-October/010210.html" target="_blank">SUCKS</a> and apparently has since 2008.</p></p>

<p><small><i> imported from:</i> <a href='https://yetanothergeographer.tumblr.com/125215868119/reflections-on-a-hard-won-win-for-pysal'<tt>yetanothergeographer</tt></a></small></p>
 </div>
    <footer class="post-footer">

  <div class="post-footer-data">
    
<div class="tags">
    
      <div class="tag">
        <a href="/tags/python">#python</a>
      </div>
    
      <div class="tag">
        <a href="/tags/gis"># gis</a>
      </div>
    
      <div class="tag">
        <a href="/tags/python-3"># python 3</a>
      </div>
    
      <div class="tag">
        <a href="/tags/py3k"># py3k</a>
      </div>
    
      <div class="tag">
        <a href="/tags/geography"># geography</a>
      </div>
    
      <div class="tag">
        <a href="/tags/pysal"># pysal</a>
      </div>
    
      <div class="tag">
        <a href="/tags/statistics"># statistics</a>
      </div>
    
      <div class="tag">
        <a href="/tags/spatial-analysis"># spatial analysis</a>
      </div>
    
      <div class="tag">
        <a href="/tags/imported">#imported</a>
      </div>
    
</div>

    <div class="date"> Jul 27, 2015 </div>
  </div>

</footer>


  


</article>

  <footer>

  <div class="social-links-footer">

  
  <a href="mailto:levi.john.wolf@gmail.com"><div class="social-link">Email</div></a>
  

  
  <a href="https://github.com/ljwolf" target="_blank"><div class="social-link">GitHub</div></a>
  

  

  
  <a href="https://twitter.com/levijohnwolf" target="_blank"><div class="social-link">Twitter</div></a>
  

  

  <div class="social-link">
  <a href="/index.xml" target="_blank">RSS</a>
  </div>

</div>


  <div class="copyright">  </div>

  <div class="poweredby">
      thanks, <a href="https://gohugo.io/">Hugo</a>.
  </div>

  </footer>

</div> 

</body>

<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>

</html>

