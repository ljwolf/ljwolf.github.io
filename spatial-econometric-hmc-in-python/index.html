<!DOCTYPE html>
<html lang="en-US">

<head>
<meta charset="utf-8" />
<meta name="author" content="" />
<meta name="description" content="Personal blog." />
<meta name="keywords" content="" />
<meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">
<meta name="generator" content="Hugo 0.36" />

<link rel="canonical" href="/spatial-econometric-hmc-in-python/">
<base href="/" />
<meta property="og:title" content="Spatial Econometric HMC in Python" />
<meta property="og:description" content="I almost forgot to mention this here: I’ve put up code on how to use some common spatial econometric models in Stan and PyMC3. For PyMC3, the implementations provide two methods that make the evaluation of thelikelihood very fast when compared to PyMC3′s native logdet function. These two methods are implemented as custom theano ops that are cache some information to improve the speed of the gradient evaluation. One uses sparse LU factorization to provides the log determinant very quickly without precomputation." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/spatial-econometric-hmc-in-python/" />



<meta property="article:published_time" content="2017-03-24T15:52:55&#43;00:00"/>

<meta property="article:modified_time" content="2017-03-24T15:52:55&#43;00:00"/>











<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Spatial Econometric HMC in Python"/>
<meta name="twitter:description" content="I almost forgot to mention this here: I’ve put up code on how to use some common spatial econometric models in Stan and PyMC3. For PyMC3, the implementations provide two methods that make the evaluation of thelikelihood very fast when compared to PyMC3′s native logdet function. These two methods are implemented as custom theano ops that are cache some information to improve the speed of the gradient evaluation. One uses sparse LU factorization to provides the log determinant very quickly without precomputation."/>



<meta itemprop="name" content="Spatial Econometric HMC in Python">
<meta itemprop="description" content="I almost forgot to mention this here: I’ve put up code on how to use some common spatial econometric models in Stan and PyMC3. For PyMC3, the implementations provide two methods that make the evaluation of thelikelihood very fast when compared to PyMC3′s native logdet function. These two methods are implemented as custom theano ops that are cache some information to improve the speed of the gradient evaluation. One uses sparse LU factorization to provides the log determinant very quickly without precomputation.">


<meta itemprop="datePublished" content="2017-03-24T15:52:55&#43;00:00" />
<meta itemprop="dateModified" content="2017-03-24T15:52:55&#43;00:00" />
<meta itemprop="wordCount" content="229">



<meta itemprop="keywords" content="" />


<link rel="stylesheet" href="css/layout.css" />
<style type="text/css">
body {
  background-color: #f5f5f5;
  color: #444444;
}

a { color: #444444; }

pre {
  background: ;
  border: 1px solid #444444;
  border-radius: 5px;
}

code {
  background: ;
}

blockquote {
  background: ;
  border-left: 3px solid #444444;
}

table {
  margin: 1em auto;
  border-collapse: collapse;
}

table, th, td {
  border: 1px solid #444444;
}

th {
  background: #444444;
  color: #f5f5f5;
}

.siteTitle a { color: #e84848; }

.post .content h1{ color: #e84848; }
.post .content h2{ color: #e84848; }
.post .content h3{ color: #e84848; }
.post .content h4{ color: #e84848; }
.post .content h5{ color: #e84848; }
.post .content h6{ color: #e84848; }
.post .content a:hover { color: #e84848; }
.social-link:hover { color: #e84848; }
.nav-item-title:hover { color: #e84848; }
.tag a:hover { color: #e84848; }
.copyright { color: #404040 }
.poweredby { color: #404040 }
.poweredby a { color: #404040; }
.post-preview .title a{ color: #e84848; }
.content-item a:hover{
  text-decoration: underline;
  color: #e84848;
}
.post-list .title { color: #e84848; }
.rmore { color: #e84848; }
.terms .term a:hover {
  text-decoration: underline;
  color: #e84848;
}

</style>



<title>


     Spatial Econometric HMC in Python 

</title>

</head>


<body>
<div class="main">
<header>

<div class="header-bar">

  <nav>
    <div class="siteTitle">
      <a href="/">Yet Another Geographer</a>
    </div> 

    
    
    <a class="nav-item" href="https://spatial.uchicago.edu"><div class="nav-item-title">Spatial@UChicago</div></a>
    
    <a class="nav-item active" href="/post/"><div class="nav-item-title">Posts</div></a>
    

  </nav>
</div>

  
<div class="social-links-header">

  

  

  

  

  

</div>


</header>


<article class="post">
    <h1 class="title"> Spatial Econometric HMC in Python </h1>
    <div class="content"> <p><p>I almost forgot to mention this here: </p><p>I’ve <a href="https://github.com/ljwolf/bayespatial" target="_blank">put up code</a> on how to use some common spatial econometric models in Stan and PyMC3. For PyMC3, the implementations provide two methods that make the evaluation of the<a href="https://github.com/ljwolf/bayespatial/blob/master/looking_at_ops.ipynb" target="_blank"> likelihood <i>very</i> fast when compared to PyMC3′s native logdet function. </a>These two methods are implemented as custom theano ops that are cache some information to improve the speed of the gradient evaluation. One uses sparse LU factorization to provides the log determinant very quickly without precomputation. The other method uses the Ord eigenvalue approach, where the determinant of (I - rho W) is computed as the product of (1 - rho lambda_i), where lambda_i are the eigenvalues of W. The logps in Stan implement only the Ord Eigenvalue computation.  </p><p>While this is nice and means that non-gradient sampling of models with these distributions is <i>very </i>fast, gradient methods are still slow. The gradient of these components require the trace of (I - rho W)^{1} W, which is a difficult matrix to obtain. I’m not sure yet if a similar property relates the trace of (I - rho W) to the eigenvalues of W, and how to leverage that when postmultiplied by W. </p><p>Regardless, the code is up there. Fork &amp; have fun. I’ll keep exploring efficient methods to get Hamiltonian Monte Carlo working on spatial models. </p>
Tags: python, spatial econometrics, econometrics, bayesian, hmc</p>
 </div>
    <footer class="post-footer">

  <div class="post-footer-data">
    
<div class="tags">
    
</div>

    <div class="date"> Mar 24, 2017 </div>
  </div>

</footer>


  


</article>

  <footer>

  <div class="social-links-footer">

  

  

  

  

  

  <div class="social-link">
  <a href="/index.xml" target="_blank">RSS</a>
  </div>

</div>


  <div class="copyright">  </div>

  <div class="poweredby">
    Powered by <a href="https://gohugo.io/">Hugo</a>.
  </div>

  </footer>

</div> 

</body>

<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>

</html>

