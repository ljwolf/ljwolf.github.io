<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1"><title>A Famously Bad Gamble - Yet Another Geographer</title>
<meta property="og:title" content="A Famously Bad Gamble - Yet Another Geographer">
<meta property="og:type" content="article">


<meta property="og:image" content="images/main.jpg">

<meta property="og:url" content="https://ljwolf.org/posts/stpetersburg/"><meta property="og:description" content="">
<meta name="Description" property="description" content="">
<link rel="me" href="https://twitter.com/@levijohnwolf">
<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@levijohnwolf">
<meta name="twitter:creator" content="@levijohnwolf">







<link rel="stylesheet" href="https://ljwolf.org/css/style.min.css">

<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/svg+xml" href="/favicon.svg">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link href="https://ljwolf.org/index.xml" type="application/atom+xml" rel="alternate" title="Sitewide Atom feed" />
<meta name="theme-color" content="#ffffff">


<script>function updateMode(){localStorage.theme==="dark"||!("theme"in localStorage)&&window.matchMedia("(prefers-color-scheme: dark)").matches?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")}function toggleMode(){localStorage.theme==="dark"?localStorage.theme="light":localStorage.theme="dark",updateMode()}window.onload=updateMode();function toggleMenu(){let e=document.getElementById("navbar-default");e.classList.contains("hidden")?e.classList.remove("hidden"):e.classList.add("hidden")}</script>

  </head>
  <body>
    <header class="md:px-0 px-2">
        <nav >
  <div class="container flex flex-wrap justify-between items-center mx-auto">
    <div class="nav-main my-2.5">
      <a href="https://ljwolf.org/" class="nav-title py-2.5 text-2xl
               text-zinc-600 dark:text-zinc-300 hover:border-b-0">Yet Another Geographer</a>
    </div>
    <button type="button"
            onclick="toggleMenu()"
            class="inline-flex items-center p-2 ml-3
                  text-sm text-gray-500
                  rounded-lg md:hidden hover:bg-gray-100
                  focus:outline-none focus:ring-2
                  focus:ring-gray-200 dark:text-gray-400
                  dark:hover:bg-gray-700 dark:focus:ring-gray-600"
            aria-controls="navbar-default"
            aria-expanded="false">
        <span class="sr-only">Open main menu</span>
        <svg class="w-6 h-6" aria-hidden="true" fill="currentColor"
             viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
          <path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1
                           0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0
                           01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0
                           01-1-1z" clip-rule="evenodd"></path>
        </svg>
    </button>
    <div class="hidden w-full md:block md:w-auto" id="navbar-default">
      <ul class="grid md:grid-flow-col items-center justify-between text-lg
                 my-2.5 grid-cols-1 pl-0 text-center">
        
        <li class="p-2.5 md:first:pl-0 md:border-none border-b dark:border-zinc-500 list-none">
          <a class="text-zinc-600 dark:text-zinc-300
                    hover:border-b-0" href="https://orcid.org/0000-0003-0274-599X">ORCID</a>
        </li>
        
        <li class="p-2.5 md:first:pl-0 md:border-none border-b dark:border-zinc-500 list-none">
          <a class="text-zinc-600 dark:text-zinc-300
                    hover:border-b-0" href="https://github.com/ljwolf">GitHub</a>
        </li>
        
        <li class="p-2.5 md:first:pl-0 md:border-none border-b dark:border-zinc-500 list-none">
          <a class="text-zinc-600 dark:text-zinc-300
                    hover:border-b-0" href="https://www.dropbox.com/scl/fi/47ze08ifgnxhme1d27k1p/currvita.pdf?rlkey=d5ujruhbwb6gevwhrakjinzo8&amp;dl=0">CV</a>
        </li>
        
        <li class="p-2.5 md:first:pl-0 md:border-none border-b dark:border-zinc-500 list-none">
          <a class="text-zinc-600 dark:text-zinc-300
                    hover:border-b-0" href="https://blog.ljwolf.org">Blog</a>
        </li>
        
        <li class="p-2.5 md:first:pl-0 md:border-none border-b dark:border-zinc-500 list-none">
          <a class="text-zinc-600 dark:text-zinc-300
                    hover:border-b-0" href="/content/books">Books</a>
        </li>
        
        <li class="p-2.5 md:first:pl-0 md:border-none border-b dark:border-zinc-500 list-none">
          <a class="text-zinc-600 dark:text-zinc-300
                    hover:border-b-0" href="/teaching">Teaching</a>
        </li>
        
        <li class="h-7 pl-2.5 pr-0 list-none">
          <button type="button" onclick="toggleMode()" class="h-full"  aria-label="Toggle between dark and light mode">
            <img class="h-7 w-7 max-h-full mb-1.5 p-1.5 hidden dark:inline"
                 id="ligh-mode-button-img"
                 alt="A sun icon for switching to light mode"
                 src="https://ljwolf.org/img/light_mode.svg">
            <img class="h-7 w-7 max-h-full mb-1.5 p-1.5 inline dark:hidden"
                 id="dark-mode-button-img"
                 alt="A moon icon for switching to dark mode"
                 src="https://ljwolf.org/img/dark_mode.svg">
          </button>
        </li>
      </ul>
    </div>
  </div>
</nav>


    </header>
    <main class="content h-card container mt-2 m-auto
                 leading-loose md:px-0 px-2 z-0"
          role="main">
    
<article class="article h-entry" itemprop="mainEntity" itemscope itemtype="http://schema.org/BlogPosting">
    <div class="title-container">
        <h1 class="article-title p-name" itemprop="name">A Famously Bad Gamble</h1>
        
        <div class="flex justify-between items-center">
            
            <a class="text-lg text-gray-600 dark:text-gray-400 border-none u-url" href="https://ljwolf.org/posts/stpetersburg/">
                <time itemprop="datePublished" class="dt-published"
                    datetime="2021-10-29T09:46:42&#43;0100"
                    content="2021-10-29T09:46:42&#43;0100">
                    2021.10.29
                </time>
            </a>
            
            
                
                <a class="text-gray-600 dark:text-gray-400 text-right border-none p-author h-card" rel="author" href="https://ljwolf.org/" itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Levi John Wolf</span></a>
                
            
        </div>
        
    </div>

    <div class="article-content e-content" itemprop="articleBody">
        <p>Man, I am <em>so</em> easily <a href="https://xkcd.com/356/">nerd-sniped</a>. First, I can just tell that <a href="https://t.co/Vv6nePZ7t6?amp=1">the wedding profession matcher</a> is going to push me to dig out all sorts of weird, distinctive patterns in the pairings between professionals. But, recently, I found myself idly simulating the answer to another kind of question altogether.</p>
<h1 id="the-st-petersburg-paradox">The St. Petersburg Paradox</h1>
<p><a href="https://en.wikipedia.org/wiki/St._Petersburg_paradox">The St. Petersburg Paradox</a> describes a game with a mathematically &ldquo;infinite&rdquo; expected payoff but one that definitely <em>does not</em> feel worth playing. The <a href="(https://en.wikipedia.org/wiki/St._Petersburg_paradox)">Wikipedia article</a> is quite good on the subject, but to put it briefly here:</p>
<blockquote>
<p>You start the game with two dollars. This is your &lsquo;stake.&rsquo; Then, the casino flips a fair coin. If that coin comes up heads, then your stake is doubled. If the coin shows tails, you stop the game and win the stake as is.</p></blockquote>
<p>Mathematically, the &ldquo;expected return&rdquo; of a game of chance or investment is the winnings multiplied by how like you are to win. Here, you can think of a bunch of different &ldquo;win states:&rdquo;</p>
<ul>
<li>you get tails on the first coin, with a payout of $2</li>
<li>you get tails on the second coin, with a payout of $4</li>
<li>you get tails on the <em>third</em> coin, with a payout of $8</li>
</ul>
<p>And so on. Theoretically, if you were <em>very</em> lucky, this could go on for a very long time, possibly infinitely long. Thus, the expected return of the game <em>overall</em> is <em>infinite</em>:</p>
<p>$$ \mathbf{E}[r] = \frac{1}{2}(2) + \frac{1}{4}(4) + \frac{1}{8}(8) + \dots = 1 + 1 + &hellip; = \infty $$</p>
<p>The paradox comes in when trying to figure out how much you might <em>pay</em> to enter this game. What&rsquo;s a fair price for entry? Well&hellip; your gut may be that you&rsquo;re very unlikely to win anything more than eight bucks. And, you&rsquo;d be right. So, you may be interested in paying <em>less</em> than that to break even.</p>
<p>So, let&rsquo;s see how often you&rsquo;d be right!</p>
<h1 id="simulating-an-answer">Simulating an Answer</h1>
<p>To figure this out empirically, you can just <em>simulate</em> the outcomes of this process, and determine what you&rsquo;d need to bet in these simulations to break even. Here, I&rsquo;ll write the gamble using Python, and we can piece together the distribution of results.</p>
<p>First, we build a python function describing the <em>game</em> itself:</p>
<div class="highlight"><div style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">import</span> <span style="color:#00f;font-weight:bold">numpy</span><span style="color:#666">,</span> <span style="color:#00f;font-weight:bold">seaborn</span>
</span></span><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">from</span> <span style="color:#00f;font-weight:bold">numba</span> <span style="color:#008000;font-weight:bold">import</span> njit <span style="color:#408080;font-style:italic"># let&#39;s go fast ðŸš€</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a2f">@njit</span>
</span></span><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">def</span> <span style="color:#00f">st_petersburg</span>(stake<span style="color:#666">=</span><span style="color:#666">2</span>, p_heads<span style="color:#666">=</span><span style="color:#666">.5</span>, max_iterations<span style="color:#666">=</span><span style="color:#666">1e9</span>):
</span></span><span style="display:flex;"><span>    i <span style="color:#666">=</span> <span style="color:#666">0</span>
</span></span><span style="display:flex;"><span>    <span style="color:#008000;font-weight:bold">while</span> i <span style="color:#666">&lt;</span> max_iterations:
</span></span><span style="display:flex;"><span>        is_tails <span style="color:#666">=</span> numpy<span style="color:#666">.</span>random<span style="color:#666">.</span>random() <span style="color:#666">&gt;</span> p_heads
</span></span><span style="display:flex;"><span>        <span style="color:#008000;font-weight:bold">if</span> is_tails:
</span></span><span style="display:flex;"><span>            <span style="color:#008000;font-weight:bold">return</span> stake
</span></span><span style="display:flex;"><span>        stake <span style="color:#666">*=</span> <span style="color:#666">2</span>
</span></span><span style="display:flex;"><span>        i <span style="color:#666">+=</span> <span style="color:#666">1</span></span></span></code></pre></td></tr></table>
</div>
</div>
<p>Now, to see this work:</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#666">&gt;&gt;&gt;</span> st_petersburg()
</span></span><span style="display:flex;"><span><span style="color:#666">2</span></span></span></code></pre></div>
<p>Oof! One game in, and we can&rsquo;t even get past the first flip! Let&rsquo;s try a few more times:</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#666">&gt;&gt;&gt;</span> st_petersburg()
</span></span><span style="display:flex;"><span><span style="color:#666">2</span>
</span></span><span style="display:flex;"><span><span style="color:#666">&gt;&gt;&gt;</span> st_petersburg()
</span></span><span style="display:flex;"><span><span style="color:#666">2</span>
</span></span><span style="display:flex;"><span><span style="color:#666">&gt;&gt;&gt;</span> st_petersburg()
</span></span><span style="display:flex;"><span><span style="color:#666">8</span>
</span></span><span style="display:flex;"><span><span style="color:#666">&gt;&gt;&gt;</span> st_petersburg()
</span></span><span style="display:flex;"><span><span style="color:#666">16</span>
</span></span><span style="display:flex;"><span><span style="color:#666">&gt;&gt;&gt;</span> st_petersburg()
</span></span><span style="display:flex;"><span><span style="color:#666">2</span></span></span></code></pre></div>
<p>OK, well, a few wins there. Let&rsquo;s go <em>all in</em> on the simulation, and construct 10,000 realizations:</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#666">&gt;&gt;&gt;</span> winnings <span style="color:#666">=</span> [st_petersburg() <span style="color:#008000;font-weight:bold">for</span> _ <span style="color:#a2f;font-weight:bold">in</span> <span style="color:#008000">range</span>(<span style="color:#666">10_000</span>)]</span></span></code></pre></div>
<p>So, we&rsquo;ve run our simulations. What do the typical winnings look like?</p>
<p>Well, we can visualize them using the <em>empirical cumulative density function</em>, which is (in my opinion), a <a href="https://medium.com/convergeml/why-ecdf-is-better-than-a-histogram-85deda4129ed">better way at understanding the distribution of values than a typical histogram.</a>.</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#666">&gt;&gt;&gt;</span> ax <span style="color:#666">=</span> seaborn<span style="color:#666">.</span>ecdfplot(winnings); ax<span style="color:#666">.</span>set_xlim(<span style="color:#666">0</span>,<span style="color:#666">50</span>); plt<span style="color:#666">.</span>show()</span></span></code></pre></div>
<p><img src="/images/stpete_ecdfplot.png" alt="Empirical CDF of Winnings in the St. Petersburg Game"></p>
<p>I think of this plot like this.</p>
<p>The line expresses <em>the fraction of values</em> that are at least as big as the X value. As you go from left to right, you &ldquo;see&rdquo; more data, and your line rises. When the line rises quickly, it means a lot of data falls in a small range of values, and when it rises slowly, it means that very few points (if any) are in that range. You can also think of the line as plotting the &ldquo;percentile&rdquo; of the value on the X axis; when the line passes through (11, .9), then you know that 11 is in the 90th percentile of values in your data, with 90% of the values being <em>smaller than (or equal to)</em> 11.</p>
<p>The nice thing about this plot is that we can <em>immediately see</em> the percent of simulations where we&rsquo;d lose money. The blue line shows you the percent of simulations where you&rsquo;d <em>lose money</em> if you paid the value on the X axis to enter the game. For example, if you paid 10 bucks to play the game, you&rsquo;d only break even or profit about 12% of the time. While that seems small, the odds of winning here are <em>quite</em> good for the player (7ish to 1 odds to win), compared to <a href="https://en.wikipedia.org/wiki/Roulette#Bet_odds_table">typical casino games</a>. But, among those games where you&rsquo;d win, you&rsquo;d only win a median of 6 bucks, over and above the entry fee. Moving to a $20 entry fee about halves this chance of breaking even, and doubles the median profit to 12 bucks. But, moving to a $40 halves your chances of breaking even <em>again</em>, but the median profit skyrockets to 88 bucks!</p>
<p>Of course, armed with this, you can decide how &ldquo;risk tolerant&rdquo; you are and find the entry price past it doesn&rsquo;t make sense for you to risk playing the game.<sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup> So, how much would <em>you</em> pay to play the St. Petersburg game?</p>
<div class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1">
<p>And, of course, I&rsquo;m not dealing with the fact this could be an <em>iterative</em> game&hellip;. say you bet $10, win 6, but then play again at $16! Your odds of breaking even immediately halve, due to the way the payout rises with entry price. The <a href="https://en.wikipedia.org/wiki/Repeated_game">theory of iterative games</a> is usually <em>way</em> more complicated than that for single games, and <a href="http://www.math.u-szeged.hu/CsorgoEmlek/talks/Gyorfi.pdf">this is no exception!</a>&#160;<a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</div>

    </div>

    

    

    
    <div class="text-neutral-500 mb-4">
        Last modified <span itemprop="dateModified"
                            datetime="2021-10-29T09:46:42&#43;0100"
                            content="2021-10-29T09:46:42&#43;0100">
        2021.10.29
        </span>
    </div>
    
</article>

    </main>
    <footer class="footer container h-10 text-center mt-1">
<hr class="my-4">
  <ul class="pl-0 mt-1">
    
    <li class="ml-2 first:before:content-none before:content-['â€¢']
               inline-block list-none">
      <a class="ml-2 text-neutral-800
                dark:text-neutral-400 border-none"
          href="https://github.com/hugcis/hugo-astatine-theme">Code</a>
    </li>
    <li class="ml-2 first:before:content-none before:content-['â€¢']
                text-neutral-800 dark:text-neutral-400 inline-block list-none">
      <span class="ml-2">Â© Levi John Wolf 2025</span>
    </li>
  </ul>
</footer>



  </body>
</html>
