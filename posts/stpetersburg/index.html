<!DOCTYPE html>
<html>
<head>
    
        
<meta charset="utf-8">
<meta name="HandheldFriendly" content="True">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="referrer" content="no-referrer-when-downgrade">

<title>A Famously Bad Gamble  - Yet Another Geographer</title>
<meta name="description" content="">

<link rel="alternate" type="application/rss+xml" title="RSS" href="/rss/">

<link rel="icon" type="image/x-icon" href="/favicon.ico">
<link rel="apple-touch-icon-precomposed" href="/favicon.png">

<link rel="stylesheet" href="/css/style.css?rnd=1635848419" />

<meta property="og:title" content="A Famously Bad Gamble" />
<meta property="og:description" content="Man, I am so easily nerd-sniped. First, I can just tell that the wedding profession matcher is going to push me to dig out all sorts of weird, distinctive patterns in the pairings between professionals. But, recently, I found myself idly simulating the answer to another kind of question altogether.
The St. Petersburg Paradox The St. Petersburg Paradox describes a game with a mathematically &ldquo;infinite&rdquo; expected payoff but one that definitely does not feel worth playing." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/stpetersburg/" />
<meta property="article:published_time" content="2021-10-29T09:46:42+01:00" />
<meta property="article:modified_time" content="2021-10-29T09:46:42+01:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="A Famously Bad Gamble"/>
<meta name="twitter:description" content="Man, I am so easily nerd-sniped. First, I can just tell that the wedding profession matcher is going to push me to dig out all sorts of weird, distinctive patterns in the pairings between professionals. But, recently, I found myself idly simulating the answer to another kind of question altogether.
The St. Petersburg Paradox The St. Petersburg Paradox describes a game with a mathematically &ldquo;infinite&rdquo; expected payoff but one that definitely does not feel worth playing."/>






    
</head>
<body>
    <div class="container">
        <header> 
            
                <h1 class="site-header">
    <a href="/">Yet Another Geographer</a>
</h1>
<nav>
    
    
    <a class="" href="/about/" title="">About</a>
    
    <a class="" href="https://www.dropbox.com/s/y5mjkduq7bopzex/currvita.pdf?dl=0" title="">CV</a>
    
    <a class="" href="http://www.bristol.ac.uk/geography/people/levi-j-wolf/overview.html" title="">Affiliation</a>
    
    <a class="" href="/teaching/" title="">Teaching</a>
    
    <a class=" active" href="/posts/" title="Posts">Posts</a>
    
</nav>

            
        </header>
        <main>
            

    <article class="post">
        <header>
            <h1>A Famously Bad Gamble</h1>
        </header>
        <div class="content">
            <p>Man, I am <em>so</em> easily <a href="https://xkcd.com/356/">nerd-sniped</a>. First, I can just tell that <a href="https://t.co/Vv6nePZ7t6?amp=1">the wedding profession matcher</a> is going to push me to dig out all sorts of weird, distinctive patterns in the pairings between professionals. But, recently, I found myself idly simulating the answer to another kind of question altogether.</p>
<h1 id="the-st-petersburg-paradox">The St. Petersburg Paradox</h1>
<p><a href="https://en.wikipedia.org/wiki/St._Petersburg_paradox">The St. Petersburg Paradox</a> describes a game with a mathematically &ldquo;infinite&rdquo; expected payoff but one that definitely <em>does not</em> feel worth playing. The <a href="(https://en.wikipedia.org/wiki/St._Petersburg_paradox)">Wikipedia article</a> is quite good on the subject, but to put it briefly here:</p>
<blockquote>
<p>You start the game with two dollars. This is your &lsquo;stake.&rsquo; Then, the casino flips a fair coin. If that coin comes up heads, then your stake is doubled. If the coin shows tails, you stop the game and win the stake as is.</p>
</blockquote>
<p>Mathematically, the &ldquo;expected return&rdquo; of a game of chance or investment is the winnings multiplied by how like you are to win. Here, you can think of a bunch of different &ldquo;win states:&rdquo;</p>
<ul>
<li>you get tails on the first coin, with a payout of $2</li>
<li>you get tails on the second coin, with a payout of $4</li>
<li>you get tails on the <em>third</em> coin, with a payout of $8</li>
</ul>
<p>And so on. Theoretically, if you were <em>very</em> lucky, this could go on for a very long time, possibly infinitely long. Thus, the expected return of the game <em>overall</em> is <em>infinite</em>:</p>
<p>$$ \mathbf{E}[r] = \frac{1}{2}(2) + \frac{1}{4}(4) + \frac{1}{8}(8) + \dots = 1 + 1 + &hellip; = \infty $$</p>
<p>The paradox comes in when trying to figure out how much you might <em>pay</em> to enter this game. What&rsquo;s a fair price for entry? Well&hellip; your gut may be that you&rsquo;re very unlikely to win anything more than eight bucks. And, you&rsquo;d be right. So, you may be interested in paying <em>less</em> than that to break even.</p>
<p>So, let&rsquo;s see how often you&rsquo;d be right!</p>
<h1 id="simulating-an-answer">Simulating an Answer</h1>
<p>To figure this out empirically, you can just <em>simulate</em> the outcomes of this process, and determine what you&rsquo;d need to bet in these simulations to break even. Here, I&rsquo;ll write the gamble using Python, and we can piece together the distribution of results.</p>
<p>First, we build a python function describing the <em>game</em> itself:</p>
<div class="highlight"><div style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#008000;font-weight:bold">import</span> <span style="color:#00f;font-weight:bold">numpy</span><span style="color:#666">,</span> <span style="color:#00f;font-weight:bold">seaborn</span>
<span style="color:#008000;font-weight:bold">from</span> <span style="color:#00f;font-weight:bold">numba</span> <span style="color:#008000;font-weight:bold">import</span> njit <span style="color:#408080;font-style:italic"># let&#39;s go fast ðŸš€</span>

<span style="color:#a2f">@njit</span>
<span style="color:#008000;font-weight:bold">def</span> <span style="color:#00f">st_petersburg</span>(stake<span style="color:#666">=</span><span style="color:#666">2</span>, p_heads<span style="color:#666">=.</span><span style="color:#666">5</span>, max_iterations<span style="color:#666">=</span><span style="color:#666">1e9</span>):
    i <span style="color:#666">=</span> <span style="color:#666">0</span>
    <span style="color:#008000;font-weight:bold">while</span> i <span style="color:#666">&lt;</span> max_iterations:
        is_tails <span style="color:#666">=</span> numpy<span style="color:#666">.</span>random<span style="color:#666">.</span>random() <span style="color:#666">&gt;</span> p_heads
        <span style="color:#008000;font-weight:bold">if</span> is_tails:
            <span style="color:#008000;font-weight:bold">return</span> stake
        stake <span style="color:#666">*=</span> <span style="color:#666">2</span>
        i <span style="color:#666">+=</span> <span style="color:#666">1</span></code></pre></td></tr></table>
</div>
</div>
<p>Now, to see this work:</p>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#666">&gt;&gt;&gt;</span> st_petersburg()
<span style="color:#666">2</span></code></pre></div>
<p>Oof! One game in, and we can&rsquo;t even get past the first flip! Let&rsquo;s try a few more times:</p>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#666">&gt;&gt;&gt;</span> st_petersburg()
<span style="color:#666">2</span>
<span style="color:#666">&gt;&gt;&gt;</span> st_petersburg()
<span style="color:#666">2</span>
<span style="color:#666">&gt;&gt;&gt;</span> st_petersburg()
<span style="color:#666">8</span>
<span style="color:#666">&gt;&gt;&gt;</span> st_petersburg()
<span style="color:#666">16</span>
<span style="color:#666">&gt;&gt;&gt;</span> st_petersburg()
<span style="color:#666">2</span></code></pre></div>
<p>OK, well, a few wins there. Let&rsquo;s go <em>all in</em> on the simulation, and construct 10,000 realizations:</p>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#666">&gt;&gt;&gt;</span> winnings <span style="color:#666">=</span> [st_petersburg() <span style="color:#008000;font-weight:bold">for</span> _ <span style="color:#a2f;font-weight:bold">in</span> <span style="color:#008000">range</span>(<span style="color:#666">10</span>_000)]</code></pre></div>
<p>So, we&rsquo;ve run our simulations. What do the typical winnings look like?</p>
<p>Well, we can visualize them using the <em>empirical cumulative density function</em>, which is (in my opinion), a <a href="https://medium.com/convergeml/why-ecdf-is-better-than-a-histogram-85deda4129ed">better way at understanding the distribution of values than a typical histogram</a>.</p>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#666">&gt;&gt;&gt;</span> ax <span style="color:#666">=</span> seaborn<span style="color:#666">.</span>ecdfplot(winnings); ax<span style="color:#666">.</span>set_xlim(<span style="color:#666">0</span>,<span style="color:#666">50</span>); plt<span style="color:#666">.</span>show()</code></pre></div>
<p><img src="/images/stpete_ecdfplot.png" alt="Empirical CDF of Winnings in the St. Petersburg Game"></p>
<p>I think of this plot like this.</p>
<p>The line expresses <em>the fraction of values</em> that are at least as big as the X value. As you go from left to right, you &ldquo;see&rdquo; more data, and your line rises. When the line rises quickly, it means a lot of data falls in a small range of values, and when it rises slowly, it means that very few points (if any) are in that range. You can also think of the line as plotting the &ldquo;percentile&rdquo; of the value on the X axis; when the line passes through (11, .9), then you know that 11 is in the 90th percentile of values in your data, with 90% of the values being <em>smaller than (or equal to)</em> 11.</p>
<p>The nice thing about this plot is that we can <em>immediately see</em> the percent of simulations where we&rsquo;d lose money. The blue line shows you the percent of simulations where you&rsquo;d <em>lose money</em> if you paid the value on the X axis to enter the game. For example, if you paid 10 bucks to play the game, you&rsquo;d only break even or profit about 12% of the time. While that seems small, the odds of winning here are <em>quite</em> good for the player (7ish to 1 odds to win), compared to <a href="https://en.wikipedia.org/wiki/Roulette#Bet_odds_table">typical casino games</a>. But, among those games where you&rsquo;d win, you&rsquo;d only win a median of 6 bucks, over and above the entry fee. Moving to a $20 entry fee about halves this chance of breaking even, and doubles the median profit to 12 bucks. But, moving to a $40 halves your chances of breaking even <em>again</em>, and the median profit skyrockets to 88 bucks!</p>
<p>Of course, armed with this, you can decide how &ldquo;risk tolerant&rdquo; you are. You can find the entry price past which it doesn&rsquo;t make sense for you to risk playing the game.<sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup> So, how much would <em>you</em> pay to play the St. Petersburg game?</p>
<section class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1" role="doc-endnote">
<p>And, of course, I&rsquo;m not dealing with the fact this could be an <em>iterative</em> game&hellip;. say you bet $10, win 6, but then play again at $16! Your odds of breaking even immediately halve, due to the way the payout rises with entry price. The <a href="https://en.wikipedia.org/wiki/Repeated_game">theory of iterative games</a> is usually <em>way</em> more complicated than that for single games, and <a href="http://www.math.u-szeged.hu/CsorgoEmlek/talks/Gyorfi.pdf">this is no exception!</a> <a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</section>

        </div>
        <div class="article-info">
    
        <div class="article-date">2021-10-29</div>
    
    <div class="article-taxonomies">
        
            
    </div>
</div>
    </article>
    


        </main>
        <footer>
            
                <p>Â© 2021<br>
Powered by <a target="_blank" href="https://gohugo.io/">Hugo</a>, theme <a target="_blank" href="https://github.com/mitrichius/hugo-theme-anubis">Anubis</a>.
</p>
<script type="text/javascript"
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
            
        </footer>
    </div>
</body>
</html>
