<!DOCTYPE html>
<html>
<head>
    
        
<meta charset="utf-8">
<meta name="HandheldFriendly" content="True">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="referrer" content="no-referrer-when-downgrade">

<title>Does projection matter for compactness indices?  - Yet Another Geographer</title>
<meta name="description" content="">

<link rel="alternate" type="application/rss+xml" title="RSS" href="/rss/">

<link rel="icon" type="image/x-icon" href="/favicon.ico">
<link rel="apple-touch-icon-precomposed" href="/favicon.png">

<link rel="stylesheet" href="/css/style.css?rnd=1635847778" />

<meta property="og:title" content="Does projection matter for compactness indices?" />
<meta property="og:description" content="This is a quick and dirty exploration of the compactness impacts of changing the projection of data on compactness measures.
import geopandas as gpd import numpy as np import matplotlib.pyplot as plt from compact import reock as _reock import pysal as ps import seaborn as sns %matplotlib inline The data I&rsquo;m using is the 113th districts from my Scientific Data publication, sourced originally from Jeff Lewis.
df = gpd.read_file(&#39;./districts113.shp&#39;).query(&#39;STATENAME not in (&#34;Alaska&#34;,&#34;Hawaii&#34;)&#39;) df." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/does-projection-matter/" />
<meta property="article:published_time" content="2018-02-18T12:40:00+00:00" />
<meta property="article:modified_time" content="2018-02-18T12:40:00+00:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Does projection matter for compactness indices?"/>
<meta name="twitter:description" content="This is a quick and dirty exploration of the compactness impacts of changing the projection of data on compactness measures.
import geopandas as gpd import numpy as np import matplotlib.pyplot as plt from compact import reock as _reock import pysal as ps import seaborn as sns %matplotlib inline The data I&rsquo;m using is the 113th districts from my Scientific Data publication, sourced originally from Jeff Lewis.
df = gpd.read_file(&#39;./districts113.shp&#39;).query(&#39;STATENAME not in (&#34;Alaska&#34;,&#34;Hawaii&#34;)&#39;) df."/>






    
</head>
<body>
    <div class="container">
        <header> 
            
                <h1 class="site-header">
    <a href="/">Yet Another Geographer</a>
</h1>
<nav>
    
    
    <a class="" href="/about/" title="">About</a>
    
    <a class="" href="https://www.dropbox.com/s/y5mjkduq7bopzex/currvita.pdf?dl=0" title="">CV</a>
    
    <a class="" href="http://www.bristol.ac.uk/geography/people/levi-j-wolf/overview.html" title="">Affiliation</a>
    
    <a class="" href="/teaching/" title="">Teaching</a>
    
    <a class=" active" href="/posts/" title="Posts">Posts</a>
    
</nav>

            
        </header>
        <main>
            

    <article class="post">
        <header>
            <h1>Does projection matter for compactness indices?</h1>
        </header>
        <div class="content">
            <p>This is a quick and dirty exploration of the compactness impacts of changing the projection of data on compactness measures.</p>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#008000;font-weight:bold">import</span> <span style="color:#00f;font-weight:bold">geopandas</span> <span style="color:#008000;font-weight:bold">as</span> <span style="color:#00f;font-weight:bold">gpd</span>
<span style="color:#008000;font-weight:bold">import</span> <span style="color:#00f;font-weight:bold">numpy</span> <span style="color:#008000;font-weight:bold">as</span> <span style="color:#00f;font-weight:bold">np</span>
<span style="color:#008000;font-weight:bold">import</span> <span style="color:#00f;font-weight:bold">matplotlib.pyplot</span> <span style="color:#008000;font-weight:bold">as</span> <span style="color:#00f;font-weight:bold">plt</span>
<span style="color:#008000;font-weight:bold">from</span> <span style="color:#00f;font-weight:bold">compact</span> <span style="color:#008000;font-weight:bold">import</span> reock <span style="color:#008000;font-weight:bold">as</span> _reock
<span style="color:#008000;font-weight:bold">import</span> <span style="color:#00f;font-weight:bold">pysal</span> <span style="color:#008000;font-weight:bold">as</span> <span style="color:#00f;font-weight:bold">ps</span>
<span style="color:#008000;font-weight:bold">import</span> <span style="color:#00f;font-weight:bold">seaborn</span> <span style="color:#008000;font-weight:bold">as</span> <span style="color:#00f;font-weight:bold">sns</span>
<span style="color:#666">%</span>matplotlib inline
</code></pre></div><p>The data I&rsquo;m using is the 113th districts from my <a href="https://osf.io/mjvkb">Scientific Data publication</a>, sourced originally from <a href="http://cdmaps.polisci.ucla.edu/">Jeff Lewis</a>.</p>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df <span style="color:#666">=</span> gpd<span style="color:#666">.</span>read_file(<span style="color:#ba2121">&#39;./districts113.shp&#39;</span>)<span style="color:#666">.</span>query(<span style="color:#ba2121">&#39;STATENAME not in (&#34;Alaska&#34;,&#34;Hawaii&#34;)&#39;</span>)
</code></pre></div><div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df<span style="color:#666">.</span>plot(color<span style="color:#666">=</span><span style="color:#ba2121">&#39;skyblue&#39;</span>, edgecolor<span style="color:#666">=</span><span style="color:#ba2121">&#39;k&#39;</span>)
plt<span style="color:#666">.</span>axis(<span style="color:#ba2121">&#39;off&#39;</span>)
plt<span style="color:#666">.</span>show()
</code></pre></div><p><img src="/images/output_4_0.png" alt="png"></p>
<p>I&rsquo;ll just check three measures, a pure area one (the convex hull areal ratio), a mixed perimeter-area one (the isoperimetric quotient), and an area-dependent one that is sensitive to the angles inherited from its planar projection (the Reock measure). The last one is notable, since its value is both dependent on the size of its minimum bounding circle, which depends on the angle preserving properties of the projection, and the accuracy of the areas of those shapes, which is not conserved by conformal projections.</p>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#008000;font-weight:bold">def</span> <span style="color:#00f">convex_hull</span>(geom):
    <span style="color:#008000;font-weight:bold">return</span> geom<span style="color:#666">.</span>area <span style="color:#666">/</span> geom<span style="color:#666">.</span>convex_hull<span style="color:#666">.</span>area
<span style="color:#008000;font-weight:bold">def</span> <span style="color:#00f">ipq</span>(geom):
    <span style="color:#008000;font-weight:bold">return</span> (<span style="color:#666">4</span><span style="color:#666">*</span>np<span style="color:#666">.</span>pi <span style="color:#666">*</span> geom<span style="color:#666">.</span>area) <span style="color:#666">/</span> (geom<span style="color:#666">.</span>boundary<span style="color:#666">.</span>length)<span style="color:#666">**</span><span style="color:#666">2</span>
<span style="color:#008000;font-weight:bold">def</span> <span style="color:#00f">reock</span>(geom):
    <span style="color:#008000;font-weight:bold">return</span> _reock(ps<span style="color:#666">.</span>cg<span style="color:#666">.</span>asShape(geom)) <span style="color:#408080;font-style:italic">#custom implementation</span>
</code></pre></div><div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">ipq_unprojected <span style="color:#666">=</span> df<span style="color:#666">.</span>geometry<span style="color:#666">.</span>apply(ipq)<span style="color:#666">.</span>values
</code></pre></div><div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">cha_unprojected <span style="color:#666">=</span> df<span style="color:#666">.</span>geometry<span style="color:#666">.</span>apply(convex_hull)<span style="color:#666">.</span>values
reock_unprojected <span style="color:#666">=</span> df<span style="color:#666">.</span>geometry<span style="color:#666">.</span>apply(reock)<span style="color:#666">.</span>values <span style="color:#408080;font-style:italic">#takes a while to solve mbc in pure python</span>
</code></pre></div><div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df<span style="color:#666">.</span>crs <span style="color:#666">=</span> {<span style="color:#ba2121">&#39;init&#39;</span>:<span style="color:#ba2121">&#39;epsg:4269&#39;</span>}
albers_eac <span style="color:#666">=</span> df<span style="color:#666">.</span>copy(deep<span style="color:#666">=</span>True)<span style="color:#666">.</span>to_crs(crs<span style="color:#666">=</span><span style="color:#ba2121">&#39;+proj=aea +lat_1=20 +lat_2=60 +lat_0=40 +lon_0=-96 +x_0=0 +y_0=0 +datum=NAD83 +units=m +no_defs&#39;</span>)
lambert_cc <span style="color:#666">=</span> df<span style="color:#666">.</span>copy(deep<span style="color:#666">=</span>True)<span style="color:#666">.</span>to_crs(crs<span style="color:#666">=</span><span style="color:#ba2121">&#39;+proj=lcc +lat_1=20 +lat_2=60 +lat_0=40 +lon_0=-96 +x_0=0 +y_0=0 +datum=NAD83 +units=m +no_defs&#39;</span>)
webmerc_ccyl <span style="color:#666">=</span> df<span style="color:#666">.</span>copy(deep<span style="color:#666">=</span>True)<span style="color:#666">.</span>to_crs(crs<span style="color:#666">=</span><span style="color:#ba2121">&#39;+proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +wktext  +no_defs&#39;</span>)
</code></pre></div><p>Visually, you can tell that something changes when you use the conic projections with preserving properties. But, the real differences are conceptual, in that the various projections will result in strongly different area, angle, and length computations for the shapes involved.</p>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">f,ax <span style="color:#666">=</span> plt<span style="color:#666">.</span>subplots(<span style="color:#666">1</span>,<span style="color:#666">4</span>,figsize<span style="color:#666">=</span>(<span style="color:#666">22</span>,<span style="color:#666">4</span>))
df<span style="color:#666">.</span>plot(color<span style="color:#666">=</span><span style="color:#ba2121">&#39;skyblue&#39;</span>, linewidth<span style="color:#666">=.</span><span style="color:#666">1</span>, ax<span style="color:#666">=</span>ax[<span style="color:#666">0</span>], edgecolor<span style="color:#666">=</span><span style="color:#ba2121">&#39;k&#39;</span>)
albers_eac<span style="color:#666">.</span>plot(color<span style="color:#666">=</span><span style="color:#ba2121">&#39;red&#39;</span>, linewidth<span style="color:#666">=.</span><span style="color:#666">1</span>, alpha<span style="color:#666">=.</span><span style="color:#666">5</span>, ax<span style="color:#666">=</span>ax[<span style="color:#666">1</span>], edgecolor<span style="color:#666">=</span><span style="color:#ba2121">&#39;k&#39;</span>)
lambert_cc<span style="color:#666">.</span>plot(color<span style="color:#666">=</span><span style="color:#ba2121">&#39;lavender&#39;</span>, linewidth<span style="color:#666">=.</span><span style="color:#666">1</span>, ax<span style="color:#666">=</span>ax[<span style="color:#666">2</span>], alpha<span style="color:#666">=</span><span style="color:#666">1</span>, edgecolor<span style="color:#666">=</span><span style="color:#ba2121">&#39;k&#39;</span>)
webmerc_ccyl<span style="color:#666">.</span>plot(color<span style="color:#666">=</span><span style="color:#ba2121">&#39;limegreen&#39;</span>, linewidth<span style="color:#666">=.</span><span style="color:#666">1</span>, ax<span style="color:#666">=</span>ax[<span style="color:#666">3</span>], alpha<span style="color:#666">=.</span><span style="color:#666">4</span>, edgecolor<span style="color:#666">=</span><span style="color:#ba2121">&#39;k&#39;</span>)
[_ax<span style="color:#666">.</span>axis(<span style="color:#ba2121">&#39;off&#39;</span>) <span style="color:#008000;font-weight:bold">for</span> _ax <span style="color:#a2f;font-weight:bold">in</span> ax]
[ax[i]<span style="color:#666">.</span>set_title([<span style="color:#ba2121">&#39;Unprojected&#39;</span>, 
                  <span style="color:#ba2121">&#39;Albers Equal Area Conic&#39;</span>,
                  <span style="color:#ba2121">&#39;Lambert Conformal Conic&#39;</span>,
                  <span style="color:#ba2121">&#39;Web Mercator&#39;</span>][i], fontsize<span style="color:#666">=</span><span style="color:#666">20</span>)  <span style="color:#008000;font-weight:bold">for</span> i <span style="color:#a2f;font-weight:bold">in</span> <span style="color:#008000">range</span>(<span style="color:#666">4</span>)]
plt<span style="color:#666">.</span>show()
</code></pre></div><p><img src="/images/output_11_0.png" alt="png"></p>
<p>Now, we can compute the three measures for each of the three projections:</p>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">cha_ea <span style="color:#666">=</span> albers_eac<span style="color:#666">.</span>geometry<span style="color:#666">.</span>apply(convex_hull)<span style="color:#666">.</span>values
cha_cc <span style="color:#666">=</span> lambert_cc<span style="color:#666">.</span>geometry<span style="color:#666">.</span>apply(convex_hull)<span style="color:#666">.</span>values
ipq_ea <span style="color:#666">=</span> albers_eac<span style="color:#666">.</span>geometry<span style="color:#666">.</span>apply(ipq)<span style="color:#666">.</span>values
ipq_cc <span style="color:#666">=</span> lambert_cc<span style="color:#666">.</span>geometry<span style="color:#666">.</span>apply(ipq)<span style="color:#666">.</span>values
reock_ea <span style="color:#666">=</span> albers_eac<span style="color:#666">.</span>geometry<span style="color:#666">.</span>apply(reock)<span style="color:#666">.</span>values
reock_cc <span style="color:#666">=</span> lambert_cc<span style="color:#666">.</span>geometry<span style="color:#666">.</span>apply(reock)<span style="color:#666">.</span>values
</code></pre></div><div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">cha_mcyl <span style="color:#666">=</span> webmerc_ccyl<span style="color:#666">.</span>geometry<span style="color:#666">.</span>apply(convex_hull)<span style="color:#666">.</span>values
ipq_mcyl <span style="color:#666">=</span> webmerc_ccyl<span style="color:#666">.</span>geometry<span style="color:#666">.</span>apply(ipq)<span style="color:#666">.</span>values
reock_mcyl <span style="color:#666">=</span> webmerc_ccyl<span style="color:#666">.</span>geometry<span style="color:#666">.</span>apply(reock)<span style="color:#666">.</span>values
</code></pre></div><div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#008000;font-weight:bold">from</span> <span style="color:#00f;font-weight:bold">scipy</span> <span style="color:#008000;font-weight:bold">import</span> stats <span style="color:#008000;font-weight:bold">as</span> st
</code></pre></div><div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">unprojected <span style="color:#666">=</span> [cha_unprojected, ipq_unprojected, reock_unprojected]
aeas <span style="color:#666">=</span> [cha_ea, ipq_ea, reock_ea]
lccs <span style="color:#666">=</span> [cha_cc, ipq_cc, reock_cc]
mcyl <span style="color:#666">=</span> [cha_mcyl, ipq_mcyl, reock_mcyl]
</code></pre></div><p>I&rsquo;ll compute their correlations in terms of both linear association and rank association.</p>
<p>Personally, I&rsquo;m more concerned about their rank association.</p>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">pearsons <span style="color:#666">=</span> [[st<span style="color:#666">.</span>pearsonr(proj,unproj) <span style="color:#008000;font-weight:bold">for</span> proj,unproj <span style="color:#a2f;font-weight:bold">in</span> <span style="color:#008000">zip</span>(unprojected, aeas)],
            [st<span style="color:#666">.</span>pearsonr(proj,unproj) <span style="color:#008000;font-weight:bold">for</span> proj,unproj <span style="color:#a2f;font-weight:bold">in</span> <span style="color:#008000">zip</span>(unprojected, lccs)],
            [[st<span style="color:#666">.</span>pearsonr(proj,unproj) <span style="color:#008000;font-weight:bold">for</span> proj,unproj <span style="color:#a2f;font-weight:bold">in</span> <span style="color:#008000">zip</span>(unprojected, mcyl)]]]
kendalls <span style="color:#666">=</span> [[st<span style="color:#666">.</span>kendalltau(proj,unproj) <span style="color:#008000;font-weight:bold">for</span> proj,unproj <span style="color:#a2f;font-weight:bold">in</span> <span style="color:#008000">zip</span>(unprojected, aeas)],
            [st<span style="color:#666">.</span>kendalltau(proj,unproj) <span style="color:#008000;font-weight:bold">for</span> proj,unproj <span style="color:#a2f;font-weight:bold">in</span> <span style="color:#008000">zip</span>(unprojected, lccs)],
            [[st<span style="color:#666">.</span>kendalltau(proj,unproj) <span style="color:#008000;font-weight:bold">for</span> proj,unproj <span style="color:#a2f;font-weight:bold">in</span> <span style="color:#008000">zip</span>(unprojected, mcyl)]]]
</code></pre></div><div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">proj_titles <span style="color:#666">=</span> [<span style="color:#ba2121">&#39;Unprojected&#39;</span>, <span style="color:#ba2121">&#39;Albers EA&#39;</span>, <span style="color:#ba2121">&#39;Lambert EC&#39;</span>, <span style="color:#ba2121">&#39;Web Mercator&#39;</span>]
measures <span style="color:#666">=</span> [<span style="color:#ba2121">&#39;Convex Hull&#39;</span>, <span style="color:#ba2121">&#39;IPQ&#39;</span>, <span style="color:#ba2121">&#39;Reock&#39;</span>]
</code></pre></div><p>And, I&rsquo;ll plot the comparisons with the unprojected measure on the X axis and the projections on the Y axis, with each comparison projection having its own row.</p>
<p>You&rsquo;ll see that, for most of the measures, the differences due to projection are quite minor. However, in all cases, the change of the Kendall&rsquo;s Tau mean that, in all cases, some districts become relatively more- or less-compact than others; they jockey for position.</p>
<p>This degrades exessively in the case of the reock measure. In this case, both the projections have a significant change in the resulting metric depending on whether a projection is used.</p>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">f,ax <span style="color:#666">=</span> plt<span style="color:#666">.</span>subplots(<span style="color:#666">3</span>,<span style="color:#666">3</span>,figsize<span style="color:#666">=</span>(<span style="color:#666">18</span>,<span style="color:#666">6</span>), sharex<span style="color:#666">=</span>True, sharey<span style="color:#666">=</span><span style="color:#ba2121">&#39;col&#39;</span>)
ax[<span style="color:#666">0</span>,<span style="color:#666">0</span>]<span style="color:#666">.</span>scatter(cha_unprojected, cha_ea)
ax[<span style="color:#666">0</span>,<span style="color:#666">0</span>]<span style="color:#666">.</span>text(s<span style="color:#666">=</span><span style="color:#ba2121">&#39;$</span><span style="color:#b62;font-weight:bold">\\</span><span style="color:#ba2121">tau={:.3f}$ &amp; $</span><span style="color:#b62;font-weight:bold">\\</span><span style="color:#ba2121">rho = {:.3f}$&#39;</span><span style="color:#666">.</span>format(kendalls[<span style="color:#666">0</span>][<span style="color:#666">0</span>]<span style="color:#666">.</span>correlation, pearsons[<span style="color:#666">0</span>][<span style="color:#666">0</span>][<span style="color:#666">0</span>]),
             x<span style="color:#666">=.</span><span style="color:#666">2</span>, y<span style="color:#666">=.</span><span style="color:#666">05</span>, fontsize<span style="color:#666">=</span><span style="color:#666">20</span>)
ax[<span style="color:#666">0</span>,<span style="color:#666">1</span>]<span style="color:#666">.</span>scatter(ipq_unprojected, ipq_ea)
ax[<span style="color:#666">0</span>,<span style="color:#666">1</span>]<span style="color:#666">.</span>text(s<span style="color:#666">=</span><span style="color:#ba2121">&#39;$</span><span style="color:#b62;font-weight:bold">\\</span><span style="color:#ba2121">tau= {:.3f}$ &amp; $</span><span style="color:#b62;font-weight:bold">\\</span><span style="color:#ba2121">rho = {:.3f}$&#39;</span><span style="color:#666">.</span>format(kendalls[<span style="color:#666">0</span>][<span style="color:#666">1</span>]<span style="color:#666">.</span>correlation, pearsons[<span style="color:#666">0</span>][<span style="color:#666">1</span>][<span style="color:#666">0</span>]),
             x<span style="color:#666">=.</span><span style="color:#666">2</span>, y<span style="color:#666">=.</span><span style="color:#666">05</span>, fontsize<span style="color:#666">=</span><span style="color:#666">20</span>)
ax[<span style="color:#666">0</span>,<span style="color:#666">2</span>]<span style="color:#666">.</span>scatter(reock_unprojected, reock_ea)
ax[<span style="color:#666">0</span>,<span style="color:#666">2</span>]<span style="color:#666">.</span>text(s<span style="color:#666">=</span><span style="color:#ba2121">&#39;$</span><span style="color:#b62;font-weight:bold">\\</span><span style="color:#ba2121">tau= {:.3f}$ &amp; $</span><span style="color:#b62;font-weight:bold">\\</span><span style="color:#ba2121">rho = {:.3f}$&#39;</span><span style="color:#666">.</span>format(kendalls[<span style="color:#666">0</span>][<span style="color:#666">2</span>]<span style="color:#666">.</span>correlation, pearsons[<span style="color:#666">0</span>][<span style="color:#666">2</span>][<span style="color:#666">0</span>]),
             x<span style="color:#666">=.</span><span style="color:#666">2</span>, y<span style="color:#666">=.</span><span style="color:#666">05</span>, fontsize<span style="color:#666">=</span><span style="color:#666">20</span>)
ax[<span style="color:#666">1</span>,<span style="color:#666">0</span>]<span style="color:#666">.</span>scatter(cha_unprojected, cha_cc)
ax[<span style="color:#666">1</span>,<span style="color:#666">0</span>]<span style="color:#666">.</span>text(s<span style="color:#666">=</span><span style="color:#ba2121">&#39;$</span><span style="color:#b62;font-weight:bold">\\</span><span style="color:#ba2121">tau= {:.3f}$ &amp; $</span><span style="color:#b62;font-weight:bold">\\</span><span style="color:#ba2121">rho = {:.3f}$&#39;</span><span style="color:#666">.</span>format(kendalls[<span style="color:#666">1</span>][<span style="color:#666">0</span>]<span style="color:#666">.</span>correlation, pearsons[<span style="color:#666">1</span>][<span style="color:#666">0</span>][<span style="color:#666">0</span>]),
             x<span style="color:#666">=.</span><span style="color:#666">2</span>, y<span style="color:#666">=.</span><span style="color:#666">05</span>, fontsize<span style="color:#666">=</span><span style="color:#666">20</span>)
ax[<span style="color:#666">1</span>,<span style="color:#666">1</span>]<span style="color:#666">.</span>scatter(ipq_unprojected, ipq_cc)
ax[<span style="color:#666">1</span>,<span style="color:#666">1</span>]<span style="color:#666">.</span>text(s<span style="color:#666">=</span><span style="color:#ba2121">&#39;$</span><span style="color:#b62;font-weight:bold">\\</span><span style="color:#ba2121">tau= {:.3f}$ &amp; $</span><span style="color:#b62;font-weight:bold">\\</span><span style="color:#ba2121">rho = {:.3f}$&#39;</span><span style="color:#666">.</span>format(kendalls[<span style="color:#666">1</span>][<span style="color:#666">1</span>]<span style="color:#666">.</span>correlation, pearsons[<span style="color:#666">1</span>][<span style="color:#666">1</span>][<span style="color:#666">0</span>]),
             x<span style="color:#666">=.</span><span style="color:#666">2</span>, y<span style="color:#666">=.</span><span style="color:#666">05</span>, fontsize<span style="color:#666">=</span><span style="color:#666">20</span>)
ax[<span style="color:#666">1</span>,<span style="color:#666">2</span>]<span style="color:#666">.</span>scatter(reock_unprojected, reock_cc)
ax[<span style="color:#666">1</span>,<span style="color:#666">2</span>]<span style="color:#666">.</span>text(s<span style="color:#666">=</span><span style="color:#ba2121">&#39;$</span><span style="color:#b62;font-weight:bold">\\</span><span style="color:#ba2121">tau= {:.3f}$ &amp; $</span><span style="color:#b62;font-weight:bold">\\</span><span style="color:#ba2121">rho = {:.3f}$&#39;</span><span style="color:#666">.</span>format(kendalls[<span style="color:#666">1</span>][<span style="color:#666">2</span>]<span style="color:#666">.</span>correlation, pearsons[<span style="color:#666">1</span>][<span style="color:#666">2</span>][<span style="color:#666">0</span>]),
             x<span style="color:#666">=.</span><span style="color:#666">2</span>, y<span style="color:#666">=.</span><span style="color:#666">05</span>, fontsize<span style="color:#666">=</span><span style="color:#666">20</span>)
ax[<span style="color:#666">2</span>,<span style="color:#666">0</span>]<span style="color:#666">.</span>scatter(cha_unprojected, cha_cc)
ax[<span style="color:#666">2</span>,<span style="color:#666">0</span>]<span style="color:#666">.</span>text(s<span style="color:#666">=</span><span style="color:#ba2121">&#39;$</span><span style="color:#b62;font-weight:bold">\\</span><span style="color:#ba2121">tau= {:.3f}$ &amp; $</span><span style="color:#b62;font-weight:bold">\\</span><span style="color:#ba2121">rho = {:.3f}$&#39;</span><span style="color:#666">.</span>format(kendalls[<span style="color:#666">1</span>][<span style="color:#666">0</span>]<span style="color:#666">.</span>correlation, pearsons[<span style="color:#666">1</span>][<span style="color:#666">0</span>][<span style="color:#666">0</span>]),
             x<span style="color:#666">=.</span><span style="color:#666">2</span>, y<span style="color:#666">=.</span><span style="color:#666">05</span>, fontsize<span style="color:#666">=</span><span style="color:#666">20</span>)
ax[<span style="color:#666">2</span>,<span style="color:#666">1</span>]<span style="color:#666">.</span>scatter(ipq_unprojected, ipq_cc)
ax[<span style="color:#666">2</span>,<span style="color:#666">1</span>]<span style="color:#666">.</span>text(s<span style="color:#666">=</span><span style="color:#ba2121">&#39;$</span><span style="color:#b62;font-weight:bold">\\</span><span style="color:#ba2121">tau= {:.3f}$ &amp; $</span><span style="color:#b62;font-weight:bold">\\</span><span style="color:#ba2121">rho = {:.3f}$&#39;</span><span style="color:#666">.</span>format(kendalls[<span style="color:#666">1</span>][<span style="color:#666">1</span>]<span style="color:#666">.</span>correlation, pearsons[<span style="color:#666">1</span>][<span style="color:#666">1</span>][<span style="color:#666">0</span>]),
             x<span style="color:#666">=.</span><span style="color:#666">2</span>, y<span style="color:#666">=.</span><span style="color:#666">05</span>, fontsize<span style="color:#666">=</span><span style="color:#666">20</span>)
ax[<span style="color:#666">2</span>,<span style="color:#666">2</span>]<span style="color:#666">.</span>scatter(reock_unprojected, reock_cc)
ax[<span style="color:#666">2</span>,<span style="color:#666">2</span>]<span style="color:#666">.</span>text(s<span style="color:#666">=</span><span style="color:#ba2121">&#39;$</span><span style="color:#b62;font-weight:bold">\\</span><span style="color:#ba2121">tau= {:.3f}$ &amp; $</span><span style="color:#b62;font-weight:bold">\\</span><span style="color:#ba2121">rho = {:.3f}$&#39;</span><span style="color:#666">.</span>format(kendalls[<span style="color:#666">1</span>][<span style="color:#666">2</span>]<span style="color:#666">.</span>correlation, pearsons[<span style="color:#666">1</span>][<span style="color:#666">2</span>][<span style="color:#666">0</span>]),
             x<span style="color:#666">=.</span><span style="color:#666">2</span>, y<span style="color:#666">=.</span><span style="color:#666">05</span>, fontsize<span style="color:#666">=</span><span style="color:#666">20</span>)
<span style="color:#008000;font-weight:bold">for</span> i,row <span style="color:#a2f;font-weight:bold">in</span> <span style="color:#008000">enumerate</span>(ax):
    <span style="color:#008000;font-weight:bold">for</span> j,ax_ <span style="color:#a2f;font-weight:bold">in</span> <span style="color:#008000">enumerate</span>(row):
        ax_<span style="color:#666">.</span>set_ylim(<span style="color:#666">0</span>,<span style="color:#666">1</span>)
        ax_<span style="color:#666">.</span>set_xlim(<span style="color:#666">0</span>,<span style="color:#666">1</span>)
        sns<span style="color:#666">.</span>despine(ax<span style="color:#666">=</span>ax_)
        <span style="color:#008000;font-weight:bold">if</span> i <span style="color:#666">==</span> <span style="color:#666">0</span>:
            ax_<span style="color:#666">.</span>set_title(measures[j], fontsize<span style="color:#666">=</span><span style="color:#666">20</span>)
        ax_<span style="color:#666">.</span>set_ylabel(proj_titles[i<span style="color:#666">+</span><span style="color:#666">1</span>], fontsize<span style="color:#666">=</span><span style="color:#666">20</span>)
        ax_<span style="color:#666">.</span>set_xlabel(proj_titles[<span style="color:#666">0</span>], fontsize<span style="color:#666">=</span><span style="color:#666">20</span>)
f<span style="color:#666">.</span>tight_layout(pad<span style="color:#666">=.</span><span style="color:#666">1</span>)
plt<span style="color:#666">.</span>show()
</code></pre></div><p><img src="/images/output_21_0.png" alt="png"></p>
<p>Critically, the projected versions themselves agree much more strongly on the reock measure than they do with the unprojected measure, with their rank and linear correlations maintaining a healthy association:</p>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">plt<span style="color:#666">.</span>scatter(reock_cc, reock_ea)
plt<span style="color:#666">.</span>text(s<span style="color:#666">=</span><span style="color:#ba2121">&#39;$</span><span style="color:#b62;font-weight:bold">\\</span><span style="color:#ba2121">tau= {:.3f}$ &amp; $</span><span style="color:#b62;font-weight:bold">\\</span><span style="color:#ba2121">rho = {:.3f}$&#39;</span><span style="color:#666">.</span>format(st<span style="color:#666">.</span>kendalltau(reock_cc, reock_ea)[<span style="color:#666">0</span>],
                                                       st<span style="color:#666">.</span>pearsonr(reock_cc, reock_ea)[<span style="color:#666">0</span>]),
             x<span style="color:#666">=.</span><span style="color:#666">2</span>, y<span style="color:#666">=.</span><span style="color:#666">05</span>, fontsize<span style="color:#666">=</span><span style="color:#666">20</span>)
sns<span style="color:#666">.</span>despine()
plt<span style="color:#666">.</span>xlabel(<span style="color:#ba2121">&#34;Lambert EC&#34;</span>, fontsize<span style="color:#666">=</span><span style="color:#666">20</span>)
plt<span style="color:#666">.</span>ylabel(<span style="color:#ba2121">&#34;Albers EA&#34;</span>, fontsize<span style="color:#666">=</span><span style="color:#666">20</span>)
plt<span style="color:#666">.</span>title(<span style="color:#ba2121">&#34;Reock&#34;</span>, fontsize<span style="color:#666">=</span><span style="color:#666">20</span>)
plt<span style="color:#666">.</span>show()
</code></pre></div><p><img src="/images/output_23_0.png" alt="png"></p>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">plt<span style="color:#666">.</span>scatter(reock_cc, reock_mcyl)
plt<span style="color:#666">.</span>text(s<span style="color:#666">=</span><span style="color:#ba2121">&#39;$</span><span style="color:#b62;font-weight:bold">\\</span><span style="color:#ba2121">tau= {:.3f}$ &amp; $</span><span style="color:#b62;font-weight:bold">\\</span><span style="color:#ba2121">rho = {:.3f}$&#39;</span><span style="color:#666">.</span>format(st<span style="color:#666">.</span>kendalltau(reock_cc, reock_mcyl)[<span style="color:#666">0</span>],
                                                       st<span style="color:#666">.</span>pearsonr(reock_cc, reock_mcyl)[<span style="color:#666">0</span>]),
             x<span style="color:#666">=.</span><span style="color:#666">2</span>, y<span style="color:#666">=.</span><span style="color:#666">05</span>, fontsize<span style="color:#666">=</span><span style="color:#666">20</span>)
sns<span style="color:#666">.</span>despine()
plt<span style="color:#666">.</span>xlabel(<span style="color:#ba2121">&#34;Lambert EC&#34;</span>, fontsize<span style="color:#666">=</span><span style="color:#666">20</span>)
plt<span style="color:#666">.</span>ylabel(<span style="color:#ba2121">&#34;Web Mercator&#34;</span>, fontsize<span style="color:#666">=</span><span style="color:#666">20</span>)
plt<span style="color:#666">.</span>title(<span style="color:#ba2121">&#34;Reock&#34;</span>, fontsize<span style="color:#666">=</span><span style="color:#666">20</span>)
plt<span style="color:#666">.</span>show()
</code></pre></div><p><img src="/images/output_24_0.png" alt="png"></p>
<h3 id="so-does-it-matter">So, does it matter?</h3>
<p>Probably not, especially at the state level, considering how strong these correlations are. However, if we were concerned with particularly pathological district shapes, we need to use the correct relevant projections.</p>
<p>Sometimes, this will be impossible, since all projections trade off accuracy in some way. But, practically speaking, these tradeoffs (at the state level) are more precise than relevant to the computation of the statistic itself.</p>

        </div>
        <div class="article-info">
    
        <div class="article-date">2018-02-18</div>
    
    <div class="article-taxonomies">
        
            
    </div>
</div>
    </article>
    


        </main>
        <footer>
            
                <p>Â© 2021<br>
Powered by <a target="_blank" href="https://gohugo.io/">Hugo</a>, theme <a target="_blank" href="https://github.com/mitrichius/hugo-theme-anubis">Anubis</a>.
</p>
<script type="text/javascript"
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
            
        </footer>
    </div>
</body>
</html>
